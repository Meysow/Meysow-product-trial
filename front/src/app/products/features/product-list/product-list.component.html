<h1 class="text-center">üõçÔ∏è Liste des Produits</h1>

<!-- üîç Filtrage des produits par cat√©gorie -->
<div class="filter-container">
  <p-dropdown
    [options]="categories()"
    [ngModel]="selectedCategory()"
    (ngModelChange)="onCategoryChange($event)"
    placeholder="Filtrer par cat√©gorie"
  >
  </p-dropdown>
</div>

<!-- üî≥ Grille des produits -->
<div class="product-grid">
  @for (product of filteredProducts(); track product.id) {
  <p-card class="product-card">
    <img
      [src]="'assets/images/placeholder.png'"
      [alt]="product.name"
      class="product-image"
    />
    <span class="category">{{ product.category }}</span>
    <div class="product-title">{{ product.name }}</div>
    <p class="product-price">{{ product.price }}‚Ç¨</p>

    <!-- üî¥ Indicateur de stock -->
    <p
      class="stock-status"
      [ngClass]="{
        'in-stock': product.inventoryStatus === 'INSTOCK',
        'low-stock': product.inventoryStatus === 'LOWSTOCK',
        'out-of-stock': product.inventoryStatus === 'OUTOFSTOCK'
      }"
    >
      {{ getStockLabel(product.inventoryStatus) }}
    </p>

    <!-- üõí Contr√¥le de quantit√© -->
    <div class="quantity-controls">
      <p-button icon="pi pi-minus" (click)="onDecreaseQuantity(product)" />
      <span class="quantity-display">
        {{ quantitiesToAdd()[product.id] || 1 }}
      </span>
      <p-button icon="pi pi-plus" (click)="onIncreaseQuantity(product)" />
    </div>

    <!-- üõí Bouton d'ajout avec d√©sactivation si OUTOFSTOCK -->
    <ng-template pTemplate="footer">
      <p-button
        label="üõí Ajouter au panier"
        (click)="onAddToCart(product)"
        [disabled]="product.inventoryStatus === 'OUTOFSTOCK'"
      />
    </ng-template>
  </p-card>
  }
</div>

<!-- üìÑ Pagination -->
<p-paginator
  [rows]="itemsPerPage()"
  [totalRecords]="totalRecords()"
  [showJumpToPageDropdown]="false"
  [showFirstLastIcon]="true"
  [alwaysShow]="false"
  (onPageChange)="onPageChange($event)"
  [showPageLinks]="true"
>
</p-paginator>
